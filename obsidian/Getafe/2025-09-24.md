Eventualmente, veremos JavaDB, Hibernate y Spring Data, progresivamente desde cómo se hacía antes hasta cómo se hace ahora.

- **JavaDB**: Es una base de datos relacional ligera que solía venir con Java (derivada de Apache Derby). Es bastante básica y buena para empezar.    
- **Hibernate**: Es un framework ORM (Object-Relational Mapping) muy usado para gestionar bases de datos de forma más avanzada y orientada a objetos.    
- **Spring Data**: Es parte del ecosistema Spring, que simplifica aún más el acceso a datos y soporta múltiples bases de datos y tecnologías.

## BBDD Continuacion

Una Primary Key puede ser una clave compuesta, es decir, formada por la combinación de varios campos.

Por ahora tenemos 3 restricciones:

- Numero de campos
- Tipo de cada campo
- PrimaryKey (not null y unique)

Iremos añadiendo mas restricciones.

- **Tamaño de campos:** Este parámetro es importante porque determina el espacio de memoria reservado para cada campo y no se ajusta automáticamente al tamaño real de los datos introducidos. Por ejemplo, si el tamaño por defecto es de 256 caracteres y se almacenan solo 9, el sistema seguirá reservando el espacio completo para 256 caracteres, sin liberar el espacio restante.

## Operaciones SQL

Los veremos en el siguiente orden:
- DDL
- DML
- DCL

En Java veremos TCL.
### 1. Operaciones de Manipulación de Datos (DML - Data Manipulation Language)

Estas operaciones permiten consultar y modificar los datos dentro de las tablas.

- **DQL (Data Query Language)**: Subconjunto de DML que se encarga exclusivamente de consultar datos.
    
    - **SELECT**: Consultar datos.  
        Es el comando principal para recuperar información de la base de datos.
        
        `SELECT columna1, columna2 FROM tabla WHERE condición;`
    
- **INSERT**: Insertar nuevos registros.
    
    `INSERT INTO tabla (columna1, columna2) VALUES (valor1, valor2);`
    
- **UPDATE**: Actualizar datos existentes.
    
    `UPDATE tabla SET columna1 = valor1 WHERE condición;`
    
- **DELETE**: Eliminar registros.
    
    `DELETE FROM tabla WHERE condición;`
    

---

### 2. Operaciones de Definición de Datos (DDL - Data Definition Language)

Se usan para definir y modificar la estructura de las tablas y otros objetos.

- **CREATE**: Crear bases de datos, tablas, índices, vistas, etc.
    
    `CREATE TABLE tabla (     id INT PRIMARY KEY,     nombre VARCHAR(100) );`
    
- **ALTER**: Modificar la estructura de una tabla (agregar columnas, cambiar tipos, etc.).
    
    `ALTER TABLE tabla ADD columna_nueva VARCHAR(50);`
    
- **DROP**: Eliminar tablas, bases de datos u otros objetos.
    
    `DROP TABLE tabla;`
    
- **TRUNCATE**: Eliminar todos los registros de una tabla sin eliminar la estructura.
    
    `TRUNCATE TABLE tabla;`
    

---

### 3. Operaciones de Control de Datos (DCL - Data Control Language)

Controlan el acceso a la base de datos.

- **GRANT**: Conceder permisos.
    
    `GRANT SELECT ON tabla TO usuario;`
    
- **REVOKE**: Revocar permisos.
    
    `REVOKE SELECT ON tabla FROM usuario;`
    

---

### 4. Operaciones de Control de Transacciones (TCL - Transaction Control Language)

Gestionan transacciones para garantizar la integridad de los datos.

- **COMMIT**: Confirmar cambios.
    
    `COMMIT;`
    
- **ROLLBACK**: Deshacer cambios.
    
    `ROLLBACK;`
    
- **SAVEPOINT**: Crear puntos de guardado dentro de una transacción.
    
    `SAVEPOINT punto1;`


## Relaciones entre tablas

### 1. **Relación Uno a Uno (1:1)**

- Cada registro en la tabla A está relacionado con **un solo registro** en la tabla B, y viceversa.
    
- Se usa cuando quieres dividir información que podría estar en una sola tabla, pero por razones de diseño o seguridad se separa.
    

**Ejemplo:**

- Tabla `Persona` y tabla `Pasaporte`.
    
- Cada persona tiene un solo pasaporte, y cada pasaporte pertenece a una sola persona.
    

---

### 2. **Relación Uno a Muchos (1:N)**

- Un registro en la tabla A puede estar relacionado con **muchos registros** en la tabla B, pero un registro en la tabla B solo puede estar relacionado con un registro en la tabla A.
    
- Es la relación más común.
    

**Ejemplo:**

- Tabla `Autor` y tabla `Libro`.
    
- Un autor puede escribir muchos libros, pero cada libro tiene un solo autor.
    

---

### 3. **Relación Muchos a Muchos (N:M)**

- Muchos registros en la tabla A pueden estar relacionados con muchos registros en la tabla B.
    
- Para implementarla se usa una **tabla intermedia** (o tabla de unión) que contiene claves foráneas de ambas tablas.
    

**Ejemplo:**

- Tabla `Estudiante` y tabla `Curso`.
    
- Un estudiante puede tomar muchos cursos, y un curso puede tener muchos estudiantes.
    
- La tabla intermedia podría ser `Estudiante_Curso` con `id_estudiante` y `id_curso`.
    

---

### Visualización rápida:

|Tipo|Descripción|Ejemplo|
|---|---|---|
|1:1|Un registro A ↔ Un registro B|Persona ↔ Pasaporte|
|1:N|Un registro A ↔ Muchos registros B|Autor ↔ Libros|
|N:M|Muchos registros A ↔ Muchos registros B|Estudiante ↔ Curso (con tabla intermedia)|

## Crear una tabla

1. Crear campos.
	1. Requiere de asignacion de nombres y tipos.
		1. Hay muchos tipos, pero principalmente vamos a usar numeros y varchar.

```sql
CREATE TABLE empleados (
    id NUMBER(5) PRIMARY KEY,                 -- Clave primaria, número de hasta 5 dígitos
    nombre VARCHAR2(50) NOT NULL,             -- Campo obligatorio, texto hasta 50 caracteres
    fecha_nacimiento DATE,                     -- Campo de tipo fecha
    salario NUMBER(10,2) CHECK (salario > 0), -- Número con hasta 8 dígitos enteros y 2 decimales, debe ser mayor que 0
    departamento_id NUMBER(3) REFERENCES departamentos(id) -- Clave foránea, referencia a la tabla departamentos
);

```

Hemos arrancado OracleXE en docker de la maquina virtual.

Hemos creado la siguiente tabla uasndo ORACLE SQL Developer.

Ejercicio 1

=============================================

Crear la tabla usuarios:
  

Columnas:

id: Entero, clave primaria.

nombre: Cadena de caracteres (VARCHAR(50)), no nula.

email: Cadena de caracteres (VARCHAR(100)), no nula y única.


```sql
CREATE TABLE tb_usuarios (
	id NUMBER(5) PRIMARY KEY,
	nombre VARCHAR(50) NOT NULL,
	email VARCHAR(100) NOT NULL UNIQUE
);
```

> [!NOTE] En ORACLE SQL Developer hay que refrescar una vez creada la tabla para que aparezca en Tablas.